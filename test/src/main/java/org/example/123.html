<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>凌云志愿个人数据库（马晓冉 女）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1677FF', // 支付宝蓝
                        secondary: '#0050B3',
                        neutral: {
                            100: '#F2F3F5',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#1D2129',
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 10px 30px -5px rgba(0, 0, 0, 0.1)',
                        'button': '0 4px 14px 0 rgba(22, 119, 255, 0.4)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .animate-fadeIn {
                animation: fadeIn 0.5s ease-in-out;
            }
            .animate-slideUp {
                animation: slideUp 0.5s ease-out;
            }
            .animate-pulse-soft {
                animation: pulseSoft 2s infinite;
            }
            .bg-gradient-primary {
                background: linear-gradient(135deg, #1677FF 0%, #0050B3 100%);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-all-300 {
                transition: all 0.3s ease;
            }
            .qr-scanned {
                animation: qrScanned 1s ease-in-out;
            }
            .animate-pulse-border {
                animation: pulseBorder 2s infinite;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulseSoft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes qrScanned {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(22, 119, 255, 0.2); }
            100% { transform: scale(1); }
        }

        @keyframes pulseBorder {
            0%, 100% { box-shadow: 0 0 0 0px rgba(22, 119, 255, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(22, 119, 255, 0.2); }
        }
    </style>
</head>
<body class="font-inter bg-gradient-to-br from-neutral-100 to-neutral-200 min-h-screen flex items-center justify-center p-4">
<!-- 支付确认页面 -->
<div id="paymentPage" class="w-full max-w-md">
    <!-- 支付卡片 -->
    <div class="bg-white rounded-2xl shadow-card overflow-hidden animate-fadeIn">
        <!-- 顶部渐变区域 -->
        <div class="bg-gradient-primary p-6 text-white relative overflow-hidden">
            <div class="absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full"></div>
            <div class="absolute -left-5 -bottom-5 w-24 h-24 bg-white/10 rounded-full"></div>

            <div class="relative z-10 flex items-center">
                <i class="fa fa-credit-card text-2xl mr-3"></i>
                <div>
                    <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-shadow mb-1">支付宝支付</h1>
                    <p class="text-white/90 text-sm">安全快捷的支付体验</p>
                </div>
            </div>
        </div>

        <!-- 金额信息 -->
        <div class="p-6 animate-slideUp" style="animation-delay: 0.1s">
            <div class="flex items-center justify-center mb-8">
                <div class="w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center">
                    <i class="fa fa-rmb text-primary text-3xl"></i>
                </div>
            </div>

            <div class="text-center mb-8">
                <p class="text-neutral-400 text-sm mb-1">付款金额</p>
                <p class="text-[clamp(2.5rem,5vw,3.5rem)] font-bold text-neutral-600 mb-2">¥1,550.00</p>
                <p class="text-primary text-sm font-medium">固定金额，无需修改</p>
            </div>

            <!-- 支付宝支付方式 -->
            <div class="mb-8 animate-slideUp" style="animation-delay: 0.2s">
                <div class="bg-primary/5 border border-primary/20 rounded-xl p-4">
                    <div class="flex items-center">
                        <img src="https://picsum.photos/seed/alipay/60/60" alt="支付宝" class="w-10 h-10 mr-3 rounded-lg">
                        <div>
                            <h3 class="font-medium text-neutral-600">支付宝</h3>
                            <p class="text-xs text-neutral-400">使用支付宝余额、银行卡或花呗支付</p>
                        </div>
                        <div class="ml-auto">
                            <i class="fa fa-check-circle text-primary text-lg"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 备注信息 -->
            <div class="mb-8 animate-slideUp" style="animation-delay: 0.3s">
                <div class="flex items-center text-neutral-500 text-sm mb-2">
                    <i class="fa fa-info-circle mr-1"></i>
                    <span>收款备注</span>
                </div>
                <p class="text-neutral-600 text-sm bg-neutral-100 p-3 rounded-lg">商品名称：高级会员服务</p>
            </div>

            <!-- 确认按钮 -->
            <div class="animate-slideUp" style="animation-delay: 0.4s">
                <button id="payBtn" class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-4 px-4 rounded-xl shadow-button transition-all-300 transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center">
                    <i class="fa fa-credit-card mr-2"></i>
                    <span>确认支付 ¥1,550.00</span>
                </button>
            </div>
        </div>

        <!-- 底部安全信息 -->
        <div class="px-6 pb-6 text-center text-neutral-400 text-xs animate-slideUp" style="animation-delay: 0.5s">
            <div class="flex justify-center items-center mb-2">
                <i class="fa fa-lock mr-1"></i>
                <span>安全支付 | 采用支付宝安全支付通道</span>
            </div>
            <p>支付完成后会自动生成电子凭证</p>
        </div>
    </div>

    <!-- 说明文字 -->
<!--    <div class="text-center mt-4 text-neutral-400 text-xs animate-fadeIn" style="animation-delay: 0.6s">-->
<!--        <p>如有疑问，请联系客服：400-123-4567</p>-->
<!--    </div>-->
</div>

<!-- 二维码支付页面 (默认隐藏) -->
<div id="qrCodePage" class="w-full max-w-md hidden">
    <div class="bg-white rounded-2xl shadow-card overflow-hidden animate-fadeIn">
        <!-- 顶部区域 -->
        <div class="p-4 border-b border-neutral-200">
            <div class="flex items-center justify-between">
                <button id="backBtn" class="flex items-center text-neutral-500 hover:text-neutral-600 transition-all-300">
                    <i class="fa fa-arrow-left mr-2"></i>
                    <span>返回</span>
                </button>
                <h2 class="font-medium text-neutral-600">扫码支付</h2>
                <div class="w-6"></div> <!-- 占位，保持标题居中 -->
            </div>
        </div>

        <!-- 二维码区域 -->
        <div class="p-6 text-center">
            <div class="mb-4">
                <p class="text-neutral-400 text-sm mb-1">请使用支付宝扫描二维码支付</p>
                <p class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-neutral-600 mb-4">¥1,550.00</p>
                <p class="text-neutral-500 text-xs mb-6">订单号: <span id="orderNumber">正在生成...</span></p>
            </div>

            <div class="bg-white p-4 rounded-xl shadow-md inline-block mb-6 animate-pulse-border">
                <!-- 这里是您的二维码图片 -->
                <img id="qrCodeImg" src="./image/img.png" alt="支付宝支付二维码" class="w-64 h-64 object-cover rounded-lg">
                <div class="mt-3 text-xs text-neutral-400">
                    <i class="fa fa-refresh mr-1"></i>
                    <span id="qrRefreshText">二维码5分钟内有效</span>
                </div>
            </div>

            <div class="mb-6">
                <p class="text-neutral-500 text-sm">
                    <i class="fa fa-mobile text-lg mr-1"></i>
                    请在支付宝客户端完成支付
                </p>
            </div>

            <!-- 支付状态 -->
            <div class="flex justify-center items-center space-x-4 mb-6">
                <button id="checkStatusBtn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all-300 flex items-center">
                    <i class="fa fa-search mr-2"></i>
                    <span>查询支付结果</span>
                </button>
                <button id="cancelPaymentBtn" class="px-4 py-2 bg-neutral-100 text-neutral-600 rounded-lg hover:bg-neutral-200 transition-all-300 flex items-center">
                    <i class="fa fa-times mr-2"></i>
                    <span>取消支付</span>
                </button>
            </div>

            <!-- 支付帮助 -->
            <div class="text-left text-sm text-neutral-400 space-y-2">
                <p>
                    <i class="fa fa-lightbulb-o mr-1"></i>
                    <span>请使用支付宝"扫一扫"扫描二维码</span>
                </p>
                <p>
                    <i class="fa fa-clock-o mr-1"></i>
                    <span>支付完成后请点击"查询支付结果"</span>
                </p>
            </div>
        </div>
    </div>

    <!-- 说明文字 -->
    <div class="text-center mt-4 text-neutral-400 text-xs">
        <p>如有疑问，请联系客服：400-123-4567</p>
    </div>
</div>

<!-- 支付成功页面 (默认隐藏) -->
<div id="successPage" class="w-full max-w-md hidden">
    <div class="bg-white rounded-2xl shadow-card overflow-hidden animate-fadeIn">
        <!-- 顶部区域 -->
        <div class="p-6 text-center">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-check text-primary text-2xl"></i>
            </div>
            <h2 class="text-xl font-bold text-neutral-600 mb-2">支付成功</h2>
            <p class="text-neutral-400 text-sm mb-6">您的订单已支付成功</p>

            <div class="bg-neutral-50 rounded-xl p-4 mb-6">
                <div class="flex justify-between items-center text-sm mb-3">
                    <span class="text-neutral-500">支付金额</span>
                    <span class="text-neutral-600 font-medium">¥1,550.00</span>
                </div>
                <div class="flex justify-between items-center text-sm mb-3">
                    <span class="text-neutral-500">支付方式</span>
                    <span class="text-neutral-600">支付宝</span>
                </div>
                <div class="flex justify-between items-center text-sm">
                    <span class="text-neutral-500">订单号</span>
                    <span id="successOrderNumber" class="text-neutral-600">20230528123456789</span>
                </div>
            </div>

            <div class="flex flex-col space-y-3">
                <button id="viewOrderBtn" class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-4 rounded-xl shadow-button transition-all-300">
                    查看订单详情
                </button>
                <button id="backToHomeBtn" class="w-full bg-white border border-neutral-200 text-neutral-600 font-medium py-3 px-4 rounded-xl hover:bg-neutral-50 transition-all-300">
                    返回首页
                </button>
            </div>
        </div>
    </div>

    <!-- 说明文字 -->
<!--    <div class="text-center mt-4 text-neutral-400 text-xs">-->
<!--        <p>电子凭证将发送至您的邮箱</p>-->
<!--    </div>-->
</div>

<script>
    // 获取DOM元素
    const paymentPage = document.getElementById('paymentPage');
    const qrCodePage = document.getElementById('qrCodePage');
    const successPage = document.getElementById('successPage');
    const payBtn = document.getElementById('payBtn');
    const backBtn = document.getElementById('backBtn');
    const checkStatusBtn = document.getElementById('checkStatusBtn');
    const cancelPaymentBtn = document.getElementById('cancelPaymentBtn');
    const viewOrderBtn = document.getElementById('viewOrderBtn');
    const backToHomeBtn = document.getElementById('backToHomeBtn');
    const qrCodeImg = document.getElementById('qrCodeImg');
    const qrRefreshText = document.getElementById('qrRefreshText');
    const orderNumberElement = document.getElementById('orderNumber');
    const successOrderNumberElement = document.getElementById('successOrderNumber');

    // 二维码刷新倒计时
    let countdown = 300; // 5分钟
    let countdownInterval;
    let currentOrderNumber;

    // 生成唯一订单号（实际应从后端获取）
    function generateOrderNumber() {
        const datePart = new Date().toISOString().replace(/[-:T.]/g, '').substring(0, 14);
        const randomPart = Math.floor(Math.random() * 1000000).toString().padStart(6, '0');
        return `ORD${datePart}${randomPart}`;
    }

    // 模拟后端创建订单
    function createOrder(amount, description) {
        return new Promise((resolve) => {
            // 实际环境中，这里应该是一个AJAX请求，调用后端API创建订单
            setTimeout(() => {
                const orderNumber = generateOrderNumber();
                // 模拟后端返回订单信息，包括订单号和支付二维码
                resolve({
                    orderNumber,
                    qrCodeUrl: `/image/img.png` // 实际应该是支付宝生成的支付二维码URL
                });
            }, 800);
        });
    }

    // 模拟查询订单状态
    function checkOrderStatus(orderNumber) {
        return new Promise((resolve) => {
            // 实际环境中，这里应该是一个AJAX请求，调用后端API查询订单状态
            setTimeout(() => {
                // 模拟50%概率支付成功
                const isPaid = Math.random() > 0.5;
                resolve({
                    isPaid,
                    paidTime: isPaid ? new Date().toISOString() : null
                });
            }, 1000);
        });
    }

    // 支付确认按钮点击事件
    payBtn.addEventListener('click', async function() {
        this.classList.add('animate-pulse-soft');

        try {
            // 调用后端API创建订单
            const orderData = await createOrder(1550.00, "高级会员服务");
            currentOrderNumber = orderData.orderNumber;

            // 更新UI显示订单号
            orderNumberElement.textContent = currentOrderNumber;
            successOrderNumberElement.textContent = currentOrderNumber;

            // 更新二维码图片
            qrCodeImg.src = orderData.qrCodeUrl;

            // 隐藏支付确认页面，显示二维码页面
            setTimeout(() => {
                paymentPage.classList.add('hidden');
                qrCodePage.classList.remove('hidden');

                // 开始倒计时
                startCountdown();

                this.classList.remove('animate-pulse-soft');
            }, 800);
        } catch (error) {
            alert('创建订单失败，请重试');
            this.classList.remove('animate-pulse-soft');
        }
    });

    // 返回按钮点击事件
    backBtn.addEventListener('click', function() {
        // 隐藏二维码页面，显示支付确认页面
        qrCodePage.classList.add('hidden');
        paymentPage.classList.remove('hidden');

        // 停止倒计时
        clearInterval(countdownInterval);
    });

    // 查询支付结果按钮点击事件
    checkStatusBtn.addEventListener('click', async function() {
        if (!currentOrderNumber) {
            alert('订单号不存在，请返回重试');
            return;
        }

        this.classList.add('animate-pulse-soft');

        try {
            // 查询订单状态
            const orderStatus = await checkOrderStatus(currentOrderNumber);

            if (orderStatus.isPaid) {
                // 支付成功，显示成功页面
                qrCodePage.classList.add('hidden');
                successPage.classList.remove('hidden');
            } else {
                alert('支付尚未完成，请继续等待或刷新二维码');
            }
        } catch (error) {
            alert('查询订单状态失败，请重试');
        } finally {
            this.classList.remove('animate-pulse-soft');
        }
    });

    // 取消支付按钮点击事件
    cancelPaymentBtn.addEventListener('click', function() {
        // 隐藏二维码页面，显示支付确认页面
        qrCodePage.classList.add('hidden');
        paymentPage.classList.remove('hidden');

        // 停止倒计时
        clearInterval(countdownInterval);
    });

    // 查看订单详情按钮点击事件
    viewOrderBtn.addEventListener('click', function() {
        if (currentOrderNumber) {
            alert(`即将跳转到订单 ${currentOrderNumber} 详情页面`);
        } else {
            alert('订单号不存在，请返回重试');
        }
    });

    // 返回首页按钮点击事件
    backToHomeBtn.addEventListener('click', function() {
        // 隐藏支付成功页面，显示支付确认页面
        successPage.classList.add('hidden');
        paymentPage.classList.remove('hidden');
    });

    // 开始倒计时
    function startCountdown() {
        updateCountdownText();

        countdownInterval = setInterval(() => {
            countdown--;

            if (countdown <= 0) {
                // 倒计时结束，刷新二维码
                refreshQRCode();
                countdown = 300; // 重置倒计时
            }

            updateCountdownText();
        }, 1000);
    }

    // 更新倒计时文本
    function updateCountdownText() {
        const minutes = Math.floor(countdown / 60);
        const seconds = countdown % 60;
        qrRefreshText.textContent = `二维码${minutes}:${seconds.toString().padStart(2, '0')}后失效`;
    }

    // 刷新二维码
    async function refreshQRCode() {
        try {
            // 添加动画效果
            qrCodeImg.classList.add('qr-scanned');

            // 调用后端API刷新订单二维码
            const orderData = await createOrder(1550.00, "高级会员服务");
            currentOrderNumber = orderData.orderNumber;

            // 更新UI显示新订单号
            orderNumberElement.textContent = currentOrderNumber;
            successOrderNumberElement.textContent = currentOrderNumber;

            // 更新二维码图片
            qrCodeImg.src = orderData.qrCodeUrl;

            // 移除动画效果
            setTimeout(() => {
                qrCodeImg.classList.remove('qr-scanned');
            }, 1000);
        } catch (error) {
            alert('刷新二维码失败，请重试');
        }
    }
</script>
</body>
</html>
